<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="yujiang-zheng&#39;s blog">
<meta property="og:url" content="http://HandsomeMars.github.io/index.html">
<meta property="og:site_name" content="yujiang-zheng&#39;s blog">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="yujiang-zheng&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://HandsomeMars.github.io/">





  <title>yujiang-zheng's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">yujiang-zheng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/08/07/ICE java实现helloworld/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/07/ICE java实现helloworld/" itemprop="url">ICE java实现helloworld</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-07T16:26:20+08:00">
                2019-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/98751745" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/98751745</a>   </p>
<p>   <strong>目录</strong></p>
<p> <a href="#main-toc">一 前言</a></p>
<p> <a href="#%E4%BA%8C%20%E5%AE%9E%E7%8E%B0">二 实现</a></p>
<p> <a href="#1%E3%80%81%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">1、目录结构</a></p>
<p> <a href="#2%E3%80%81java%E5%AE%9E%E7%8E%B0">2、java实现</a></p>
<p> <a href="#3%E3%80%81spring%E5%AE%9E%E7%8E%B0%EF%BC%88spring%E5%90%AF%E5%8A%A8ice%EF%BC%89">3、spring实现（spring启动ice）</a></p>
<p> <a href="#%E5%9B%9B%20%E9%A1%B9%E7%9B%AEgit%C2%A0%C2%A0https%3A%2F%2Fgithub.com%2FHandsomeMars%2Fspringboot-ice-demo">三 项目git https://github.com/HandsomeMars/springboot-ice-demo</a></p>
<hr>
<h2 id="一-前言"><a href="#一-前言" class="headerlink" title="一 前言"></a><strong>一 前言</strong></h2><p> <em>1、基于上篇slice2java编译，本文接着使用slice2java实现简单的客户端和服务端</em></p>
<p> <em>2、本文列举两种实现：</em></p>
<ul>
<li>java main方法调用 </li>
<li>结合spring IOC容器管理 <h2 id="二-实现"><a href="#二-实现" class="headerlink" title="二 实现"></a>二 实现</h2></li>
</ul>
<h3 id="1、目录结构"><a href="#1、目录结构" class="headerlink" title="1、目录结构"></a><em>1、目录结构</em></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> src</span><br><span class="line">├─main</span><br><span class="line">│  ├─java</span><br><span class="line">│  │  ├─com</span><br><span class="line">│  │  │  └─zyj</span><br><span class="line">│  │  │      │  SpringbootIceApplication.java</span><br><span class="line">│  │  │      │</span><br><span class="line">│  │  │      ├─ice</span><br><span class="line">│  │  │      │  ├─java     ##java实现</span><br><span class="line">│  │  │      │  │  ├─client</span><br><span class="line">│  │  │      │  │  │      IceClient.java</span><br><span class="line">│  │  │      │  │  │</span><br><span class="line">│  │  │      │  │  └─server</span><br><span class="line">│  │  │      │  │          HelloServant.java</span><br><span class="line">│  │  │      │  │          IceService.java</span><br><span class="line">│  │  │      │  │</span><br><span class="line">│  │  │      │  └─spring   ##spring结合</span><br><span class="line">│  │  │      │      ├─client</span><br><span class="line">│  │  │      │      │      IceClient.java</span><br><span class="line">│  │  │      │      │</span><br><span class="line">│  │  │      │      └─server</span><br><span class="line">│  │  │      │              HelloServant.java</span><br><span class="line">│  │  │      │              IceService.java</span><br><span class="line">│  │  │      │</span><br><span class="line">│  │  │      └─util</span><br><span class="line">│  │  │              SpringContextUtil.java</span><br><span class="line">│  │  │</span><br><span class="line">│  │  └─slice2java        ##slice生成文件</span><br><span class="line">│  │          Callback_HelloI_hello.java</span><br><span class="line">│  │          HelloI.java</span><br><span class="line">│  │          HelloIHolder.java</span><br><span class="line">│  │          HelloIPrx.java</span><br><span class="line">│  │          HelloIPrxHelper.java</span><br><span class="line">│  │          HelloIPrxHolder.java</span><br><span class="line">│  │          _Callback_HelloI_hello.java</span><br><span class="line">│  │          _HelloIDisp.java</span><br><span class="line">│  │          _HelloIOperations.java</span><br><span class="line">│  │          _HelloIOperationsNC.java</span><br><span class="line">│  │</span><br><span class="line">│  └─resources</span><br><span class="line">│      │  application.properties</span><br><span class="line">│      │</span><br><span class="line">│      └─slice</span><br><span class="line">│              slice.bat</span><br><span class="line">│              test.ice</span><br><span class="line">│</span><br><span class="line">└─test</span><br><span class="line">    └─java</span><br><span class="line">        └─com</span><br><span class="line">            └─zyj</span><br><span class="line">                    SpringbootIceApplicationTests.java</span><br></pre></td></tr></table></figure>


<h3 id="2、java实现"><a href="#2、java实现" class="headerlink" title="2、java实现"></a><em>2、java实现</em></h3><p> <strong><em>step1: HelloServant 实现服务端 _xxxDisp抽象类</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.java.server;</span><br><span class="line"></span><br><span class="line">import Ice.Current;</span><br><span class="line">import Ice.StringHolder;</span><br><span class="line">import slice2java._HelloIDisp;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">public class HelloServant extends _HelloIDisp &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public int hello(String instr, StringHolder outstr, Current __current) &#123;</span><br><span class="line">        System.out.println(&quot;server接受：&quot;+instr+&quot; 时间：&quot;+System.currentTimeMillis());</span><br><span class="line">        outstr.value=&quot;hello client&quot;;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>_setp2:配置server _</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.java.server;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">public class IceService &#123;</span><br><span class="line">    /**服务名*/</span><br><span class="line">    private static final String SERVER_NAME=&quot;Hello&quot;;</span><br><span class="line">    /**服务端点*/</span><br><span class="line">    private static final String SERVER_ENDPOINT=&quot;tcp -p 10006&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //获取实现类 SpringContextUtil.getBean(helloServant)</span><br><span class="line">        HelloServant helloServant=new HelloServant();</span><br><span class="line"></span><br><span class="line">        //ice通信器</span><br><span class="line">        Ice.Communicator communicator = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //初始化ice通信器communicator,可以使用args传入一下ice初始化的参数如超时时间，线程池大小等</span><br><span class="line">            communicator = Ice.Util.initialize(args);</span><br><span class="line"></span><br><span class="line">            //创建一个名为queryEmployeeAdapter的适配器并且默认使用tcp协议  服务部署在10.4.30.81机器上 服务开启10006监听端口</span><br><span class="line"></span><br><span class="line">            Ice.ObjectAdapter adapter = communicator.createObjectAdapterWithEndpoints(SERVER_NAME,SERVER_ENDPOINT);</span><br><span class="line"></span><br><span class="line">            // 将servant与ice对象标识符建立映射关系，并添加到ice对象适配器中</span><br><span class="line">            adapter.add(helloServant, Ice.Util.stringToIdentity(SERVER_NAME));</span><br><span class="line"></span><br><span class="line">            // 激活对象适配器</span><br><span class="line">            adapter.activate();</span><br><span class="line"></span><br><span class="line">            System.out.println(&quot;服务启动&quot;);</span><br><span class="line">            // 服务在退出之前一直保持监听状态</span><br><span class="line">            communicator.waitForShutdown();</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally&#123;</span><br><span class="line">            //异常销毁通信器</span><br><span class="line">            if(communicator != null)&#123;</span><br><span class="line">                communicator.destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong><em>step3:IceClient 使用 xxxPrxHelper 获取 xxxPrx</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.java.client;</span><br><span class="line"></span><br><span class="line">import Ice.StringHolder;</span><br><span class="line">import slice2java.HelloIPrx;</span><br><span class="line">import slice2java.HelloIPrxHelper;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">public class IceClient &#123;</span><br><span class="line"></span><br><span class="line">    /**服务名*/</span><br><span class="line">    private static final String SERVER_NAME=&quot;Hello&quot;;</span><br><span class="line">    /**服务端点*/</span><br><span class="line">    private static final String SERVER_ENDPOINT=&quot;tcp -h 127.0.0.1 -p 10006&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //ice通信器</span><br><span class="line">        Ice.Communicator communicator = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //初始化ice通信器communicator,可以使用args传入一下ice初始化的参数如超时时间，线程池大小等</span><br><span class="line">            communicator = Ice.Util.initialize(args);</span><br><span class="line"></span><br><span class="line">            //构建服务端的代理对象  服务端对象标识以 SERVER_NAME:SERVER_ENDPOINT 格式</span><br><span class="line">            Ice.ObjectPrx op = communicator.stringToProxy(SERVER_NAME+&quot;:&quot;+SERVER_ENDPOINT);</span><br><span class="line"></span><br><span class="line">            //检查通用客户端代理op 是不是queryServer对象标识符所关联的ice对象的代理</span><br><span class="line">            HelloIPrx qp = HelloIPrxHelper.checkedCast(op);</span><br><span class="line"></span><br><span class="line">            if(qp == null)&#123;</span><br><span class="line">                throw new Exception(&quot;qp == null&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            //测试发送信息到户无端</span><br><span class="line">            StringHolder holder=new StringHolder();</span><br><span class="line">            int result = qp.hello(&quot;hello&quot;,holder);</span><br><span class="line"></span><br><span class="line">            // 输出服务端返回结果</span><br><span class="line">            System.out.println(&quot;client接受：&quot;+holder.value+&quot; 时间：&quot;+System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong><em>step4:启动验证</em></strong></p>
<p> <em>启动server</em></p>
<p> <img src="https://img-blog.csdnimg.cn/2019080715521381.png" alt></p>
<p> _ 启动client_</p>
<p> <img src="https://img-blog.csdnimg.cn/20190807155433714.png" alt><img src="https://img-blog.csdnimg.cn/20190807155445911.png" alt></p>
<h3 id="3、spring实现（spring启动ice）"><a href="#3、spring实现（spring启动ice）" class="headerlink" title="3、spring实现（spring启动ice）"></a><em>3、spring实现（spring启动ice）</em></h3><p> <strong><em>step1：改造服务实现类（添加@Service注解）</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.spring.server;</span><br><span class="line"></span><br><span class="line">import Ice.Current;</span><br><span class="line">import Ice.StringHolder;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import slice2java._HelloIDisp;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">@Service</span><br><span class="line">public class HelloServant extends _HelloIDisp &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public int hello(String instr, StringHolder outstr, Current __current) &#123;</span><br><span class="line">        System.out.println(&quot;server接受：&quot;+instr+&quot; 时间：&quot;+System.currentTimeMillis());</span><br><span class="line">        outstr.value=&quot;hello client&quot;;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>_ step2：改造server 主要防止ice阻塞，所以通过线程处理_</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.spring.server;</span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line">import javax.annotation.PostConstruct;</span><br><span class="line">import java.util.concurrent.LinkedBlockingQueue;</span><br><span class="line">import java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">@Service</span><br><span class="line">public class IceService implements Runnable&#123;</span><br><span class="line"></span><br><span class="line">    /**服务名*/</span><br><span class="line">    private static final String SERVER_NAME=&quot;Hello&quot;;</span><br><span class="line">    /**服务端点*/</span><br><span class="line">    private static final String SERVER_ENDPOINT=&quot;tcp -p 10006&quot;;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private HelloServant helloServant;</span><br><span class="line"></span><br><span class="line">    @PostConstruct</span><br><span class="line">    private void startIceServer() &#123;</span><br><span class="line">        //构造线程池启动当前任务</span><br><span class="line">        LinkedBlockingQueue&lt;Runnable&gt; runnableList=new LinkedBlockingQueue&lt;Runnable&gt;();</span><br><span class="line">        ThreadPoolExecutor threadPoolExecutor= new ThreadPoolExecutor(100,100,1L, TimeUnit.SECONDS,runnableList);</span><br><span class="line">        threadPoolExecutor.execute(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        //ice通信器</span><br><span class="line">        Ice.Communicator communicator = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //初始化ice通信器communicator,可以使用args传入一下ice初始化的参数如超时时间，线程池大小等</span><br><span class="line">            communicator = Ice.Util.initialize();</span><br><span class="line"></span><br><span class="line">            //创建一个名为queryEmployeeAdapter的适配器并且默认使用tcp协议  服务部署在10.4.30.81机器上 服务开启10006监听端口</span><br><span class="line"></span><br><span class="line">            Ice.ObjectAdapter adapter = communicator.createObjectAdapterWithEndpoints(SERVER_NAME,SERVER_ENDPOINT);</span><br><span class="line"></span><br><span class="line">            // 将servant与ice对象标识符建立映射关系，并添加到ice对象适配器中</span><br><span class="line">            adapter.add(helloServant, Ice.Util.stringToIdentity(SERVER_NAME));</span><br><span class="line"></span><br><span class="line">            // 激活对象适配器</span><br><span class="line">            adapter.activate();</span><br><span class="line"></span><br><span class="line">            System.out.println(&quot;服务启动&quot;);</span><br><span class="line">            // 服务在退出之前一直保持监听状态</span><br><span class="line">            communicator.waitForShutdown();</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally&#123;</span><br><span class="line">            //异常销毁通信器</span><br><span class="line">            if(communicator != null)&#123;</span><br><span class="line">                communicator.destroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong><em>step3：改造客户端（客户端连接服务端后,可以保持服务端xxxPrx对象持续调用）</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"> package com.zyj.ice.spring.client;</span><br><span class="line"></span><br><span class="line">import Ice.StringHolder;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import slice2java.HelloIPrx;</span><br><span class="line">import slice2java.HelloIPrxHelper;</span><br><span class="line"></span><br><span class="line">import javax.annotation.PostConstruct;</span><br><span class="line">import java.util.concurrent.LinkedBlockingQueue;</span><br><span class="line">import java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author by zyj</span><br><span class="line"> * @version V1.0</span><br><span class="line"> * @Description:</span><br><span class="line"> * @Date 2019/8/6 21:13</span><br><span class="line"> */</span><br><span class="line">@Service</span><br><span class="line">public class IceClient implements Runnable&#123;</span><br><span class="line"></span><br><span class="line">    /**服务名*/</span><br><span class="line">    private static final String SERVER_NAME=&quot;Hello&quot;;</span><br><span class="line">    /**服务端点*/</span><br><span class="line">    private static final String SERVER_ENDPOINT=&quot;tcp -h 127.0.0.1 -p 10006&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @PostConstruct</span><br><span class="line">    private void startIceClient() &#123;</span><br><span class="line">        //构造线程启动客户端</span><br><span class="line">        LinkedBlockingQueue&lt;Runnable&gt; runnableList=new LinkedBlockingQueue&lt;Runnable&gt;();</span><br><span class="line">        ThreadPoolExecutor threadPoolExecutor= new ThreadPoolExecutor(100,100,1L, TimeUnit.SECONDS,runnableList);</span><br><span class="line">        threadPoolExecutor.execute(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        //ice通信器</span><br><span class="line">        Ice.Communicator communicator = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //初始化ice通信器communicator,可以使用args传入一下ice初始化的参数如超时时间，线程池大小等</span><br><span class="line">            communicator = Ice.Util.initialize();</span><br><span class="line"></span><br><span class="line">            //构建服务端的代理对象  服务端对象标识以 SERVER_NAME:SERVER_ENDPOINT 格式</span><br><span class="line">            Ice.ObjectPrx op = communicator.stringToProxy(SERVER_NAME+&quot;:&quot;+SERVER_ENDPOINT);</span><br><span class="line"></span><br><span class="line">            //检查通用客户端代理op 是不是queryServer对象标识符所关联的ice对象的代理</span><br><span class="line">            HelloIPrx qp = HelloIPrxHelper.checkedCast(op);</span><br><span class="line"></span><br><span class="line">            if(qp == null)&#123;</span><br><span class="line">                throw new Exception(&quot;qp == null&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            //测试发送信息到户无端</span><br><span class="line">            StringHolder holder=new StringHolder();</span><br><span class="line">            int result = qp.hello(&quot;hello&quot;,holder);</span><br><span class="line"></span><br><span class="line">            // 输出服务端返回结果</span><br><span class="line">            System.out.println(&quot;client请求结果：&quot;+holder.value+&quot; 时间：&quot;+System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong><em>step4 启动</em></strong></p>
<p> <img src="https://img-blog.csdnimg.cn/20190807162155420.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h2 id="三-项目git-https-github-com-HandsomeMars-springboot-ice-demo"><a href="#三-项目git-https-github-com-HandsomeMars-springboot-ice-demo" class="headerlink" title="三 项目git https://github.com/HandsomeMars/springboot-ice-demo"></a>三 项目git <a href="https://github.com/HandsomeMars/springboot-ice-demo" target="_blank" rel="noopener">https://github.com/HandsomeMars/springboot-ice-demo</a></h2><p> <strong><em><a href="https://github.com/HandsomeMars/springboot-ice-demo" target="_blank" rel="noopener">https://github.com/HandsomeMars/springboot-ice-demo</a></em></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/08/07/ICE插件 编译slice2java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/07/ICE插件 编译slice2java/" itemprop="url">ICE插件 编译slice2java</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-07T15:25:39+08:00">
                2019-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/98743742" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/98743742</a>   </p>
<p>   <strong>目录</strong></p>
<p> <a href="#%E4%B8%80%C2%A0%20%E5%89%8D%E8%A8%80">一 前言</a></p>
<p> <a href="#%E4%BA%8C%20%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0">二 插件实现</a></p>
<p> <a href="#%E4%B8%89%20%E5%91%BD%E4%BB%A4%E5%AE%9E%E7%8E%B0">三 命令实现</a></p>
<p> <a href="#%C2%A0%E5%9B%9B%20%E9%A1%B9%E7%9B%AEgit%C2%A0https%3A%2F%2Fgithub.com%2FHandsomeMars%2Fspringboot-ice-demo"> 四 项目git https://github.com/HandsomeMars/springboot-ice-demo</a></p>
<hr>
<h2 id="一-前言"><a href="#一-前言" class="headerlink" title="一 前言"></a>一 前言</h2><p> <em>1、ICE使用slice文件经定义协议文档，针对不同语言进行编译实现，本文阐述如何将slice文件编译为java类</em></p>
<p> <em>2、ICE编译slice文件主要使用 slice2java命令，本文提供两种实现：</em></p>
<ul>
<li><p>maven-plugin（idea） </p>
</li>
<li><p>bat（需要安装ice和配置环境变量）<a href="https://blog.csdn.net/qq_22211217/article/details/89200417" target="_blank" rel="noopener">windows配置ICE环境变量</a> </p>
<h2 id="二-插件实现"><a href="#二-插件实现" class="headerlink" title="二 插件实现"></a>二 插件实现</h2><p><strong><em>1、slice文件</em></strong></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> module slice2java</span><br><span class="line">&#123;</span><br><span class="line"> interface HelloI</span><br><span class="line"> &#123;</span><br><span class="line">  int  hello(string instr,out string outstr);</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p> <strong><em>2、文件目录</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> src</span><br><span class="line">├─main</span><br><span class="line">│  ├─java</span><br><span class="line">│  │  ├─.depend ##插件生成.depend文件 防止重复生成</span><br><span class="line">│  │  └─slice2java ##对应slice文件 module（包名） 下面为接口生成java代码</span><br><span class="line">│  │              Callback_HelloI_hello.java</span><br><span class="line">│  │              HelloI.java</span><br><span class="line">│  │              HelloIHolder.java</span><br><span class="line">│  │              HelloIPrx.java</span><br><span class="line">│  │              HelloIPrxHelper.java</span><br><span class="line">│  │              HelloIPrxHolder.java</span><br><span class="line">│  │              _Callback_HelloI_hello.java</span><br><span class="line">│  │              _HelloIDisp.java</span><br><span class="line">│  │              _HelloIOperations.java</span><br><span class="line">│  │              _HelloIOperationsNC.java</span><br><span class="line">│  │</span><br><span class="line">│  └─resources</span><br><span class="line">│      └─slice</span><br><span class="line">│              test.ice</span><br><span class="line">│</span><br><span class="line">└─test</span><br><span class="line">    └─java</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> slice文件放置为 src/main/resource/slice</span><br><span class="line">silce2java文件放置为 src/main/java/</span><br><span class="line"></span><br><span class="line">##slice2java文件必须放置src/main/java/ 否则生成的java文件包名出错</span><br><span class="line">对应插件配置如下</span><br></pre></td></tr></table></figure>

<p> <strong><em>3、pom文件插件配置</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">      &lt;plugins&gt;</span><br><span class="line">          &lt;plugin&gt;</span><br><span class="line">              &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">              &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;</span><br><span class="line">              &lt;version&gt;1.8&lt;/version&gt;</span><br><span class="line">              &lt;executions&gt;</span><br><span class="line">                  &lt;execution&gt;</span><br><span class="line">                      &lt;id&gt;default-cli&lt;/id&gt;</span><br><span class="line">                      &lt;phase&gt;generate-sources&lt;/phase&gt;</span><br><span class="line">                      &lt;configuration&gt;</span><br><span class="line">                          &lt;target name=&quot;slice2java&quot;&gt;</span><br><span class="line">                              &lt;taskdef name=&quot;slice2java&quot; classname=&quot;Slice2JavaTask&quot;</span><br><span class="line">                                       classpathref=&quot;maven.plugin.classpath&quot;/&gt;</span><br><span class="line">                              &lt;!--slice2java路径--&gt;</span><br><span class="line">                              &lt;slice2java outputdir=&quot;src/main/java/&quot;&gt;</span><br><span class="line">                                  &lt;!--slice文件列表 输入路径--&gt;</span><br><span class="line">                                  &lt;fileset dir=&quot;src/main/resources/slice&quot; includes=&quot;**/*.ice&quot;/&gt;</span><br><span class="line">                                  &lt;!--&lt;includepath&gt;--&gt;</span><br><span class="line">                                  &lt;!--&lt;pathelement path=&quot;src/main/java/com/zyj/ice/slice&quot;/&gt;--&gt;</span><br><span class="line">                                  &lt;!--&lt;/includepath&gt;--&gt;</span><br><span class="line">                              &lt;/slice2java&gt;</span><br><span class="line">                          &lt;/target&gt;</span><br><span class="line">                      &lt;/configuration&gt;</span><br><span class="line">                      &lt;goals&gt;</span><br><span class="line">                          &lt;goal&gt;run&lt;/goal&gt;</span><br><span class="line">                      &lt;/goals&gt;</span><br><span class="line">                  &lt;/execution&gt;</span><br><span class="line"></span><br><span class="line">              &lt;/executions&gt;</span><br><span class="line">              &lt;dependencies&gt;</span><br><span class="line">                  &lt;!-- https://mvnrepository.com/artifact/com.zeroc/ant-ice --&gt;</span><br><span class="line">                  &lt;dependency&gt;</span><br><span class="line">                      &lt;groupId&gt;com.zeroc&lt;/groupId&gt;</span><br><span class="line">                      &lt;artifactId&gt;ant-ice&lt;/artifactId&gt;</span><br><span class="line">                      &lt;version&gt;4.1.0&lt;/version&gt;</span><br><span class="line">                  &lt;/dependency&gt;</span><br><span class="line">              &lt;/dependencies&gt;</span><br><span class="line">          &lt;/plugin&gt;</span><br><span class="line">      &lt;/plugins&gt;</span><br><span class="line">  &lt;/build&gt;</span><br></pre></td></tr></table></figure>

<p> <em>*<em>4、配置结果 *</em></em></p>
<p> <img src="https://img-blog.csdnimg.cn/20190807144058632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt> </p>
<p> <em>*<em>5、点击plugin -》antrun:run-》刷新目录，slice2java生成代码 *</em></em></p>
<p> <img src="https://img-blog.csdnimg.cn/20190807150900655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h2 id="三-命令实现"><a href="#三-命令实现" class="headerlink" title="三 命令实现"></a>三 命令实现</h2><p> <strong><em>1、ice环境搭建</em></strong></p>
<p> <a href="https://blog.csdn.net/qq_22211217/article/details/89200417" target="_blank" rel="noopener">windows配置ICE环境变量</a></p>
<p> <strong><em>2、bat文件</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">echo ********************* slice2java **************************</span><br><span class="line">set  javaFile_des=..\..\java\</span><br><span class="line"></span><br><span class="line">echo rd /s /Q %javaFile_des%</span><br><span class="line">md %javaFile_des%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for /R ./ %%s in (*.ice) do (</span><br><span class="line">	slice2java --output-dir %javaFile_des% -I. %%s</span><br><span class="line">	echo %%s </span><br><span class="line">) </span><br><span class="line">pause</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> ############################命令简单注释##########################</span><br><span class="line"></span><br><span class="line">set  javaFile_des=..\..\java\ </span><br><span class="line">## 设置java输出路径  相对路径 ..\命令环境上级 ..\..\命令环境上上级</span><br><span class="line"></span><br><span class="line">md %javaFile_des%</span><br><span class="line">## md 创建输出文件夹   即src\mian\java\</span><br><span class="line"></span><br><span class="line">for /R ./ %%s in (*.ice) do (</span><br><span class="line">	slice2java --output-dir %javaFile_des% -I. %%s</span><br><span class="line">	echo %%s </span><br><span class="line">) </span><br><span class="line">## for循环读取 </span><br><span class="line">##./当前目录下 </span><br><span class="line">##.ice文件  </span><br><span class="line">##slice2java 编译命令 还有slice2ccp 等</span><br><span class="line">##--output-dir指定输出目录  </span><br><span class="line">##-I忽略警告</span><br><span class="line">############################命令简单注释##########################</span><br></pre></td></tr></table></figure>

<p> <em>*<em>3、目录结构 *</em></em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> ├─main</span><br><span class="line">│  ├─java</span><br><span class="line">│  │  └─slice2java  ##对应slice文件 module（包名） 下面为接口生成java代码</span><br><span class="line">│  │              Callback_HelloI_hello.java</span><br><span class="line">│  │              HelloI.java</span><br><span class="line">│  │              HelloIHolder.java</span><br><span class="line">│  │              HelloIPrx.java</span><br><span class="line">│  │              HelloIPrxHelper.java</span><br><span class="line">│  │              HelloIPrxHolder.java</span><br><span class="line">│  │              _Callback_HelloI_hello.java</span><br><span class="line">│  │              _HelloIDisp.java</span><br><span class="line">│  │              _HelloIOperations.java</span><br><span class="line">│  │              _HelloIOperationsNC.java</span><br><span class="line">│  │</span><br><span class="line">│  └─resources</span><br><span class="line">│      └─slice</span><br><span class="line">│              slice.bat  ##批处理文件</span><br><span class="line">│              test.ice</span><br><span class="line">│</span><br><span class="line">└─test</span><br><span class="line">    └─java</span><br></pre></td></tr></table></figure>

<p> <em>*<em>4、运行bat *</em></em></p>
<p> <img src="https://img-blog.csdnimg.cn/20190807151004785.png" alt></p>
<h2 id="四-项目git-https-github-com-HandsomeMars-springboot-ice-demo"><a href="#四-项目git-https-github-com-HandsomeMars-springboot-ice-demo" class="headerlink" title="四 项目git https://github.com/HandsomeMars/springboot-ice-demo"></a>四 项目git <a href="https://github.com/HandsomeMars/springboot-ice-demo" target="_blank" rel="noopener">https://github.com/HandsomeMars/springboot-ice-demo</a></h2><p> <a href="https://github.com/HandsomeMars/springboot-ice-demo" target="_blank" rel="noopener">https://github.com/HandsomeMars/springboot-ice-demo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/07/25/swagger离线文档导出html（maven插件版）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/25/swagger离线文档导出html（maven插件版）/" itemprop="url">swagger离线文档导出html（maven插件版）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-25T22:44:21+08:00">
                2019-07-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/97301464" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/97301464</a>   </p>
<p>   <strong>目录</strong></p>
<p> <a href="#%E4%B8%80%C2%A0%20%E5%89%8D%E8%A8%80">一 前言</a></p>
<p> <a href="#1%E3%80%81swagger%E4%BD%9C%E4%B8%BA%E5%87%BA%E8%89%B2%E7%9A%84%E5%9C%A8%E7%BA%BFapi%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%BB%8F%E5%B8%B8%E4%BD%9C%E4%B8%BA%E5%89%8D%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3%E5%AF%B9%E6%8E%A5%E7%9A%84%E5%88%A9%E5%99%A8%E3%80%82">1、swagger作为出色的在线api生成工具，在项目中经常作为前后端接口对接的利器。</a></p>
<p> <a href="#2%E3%80%81%E6%9C%AC%E6%96%87%E4%B8%8D%E9%98%90%E8%BF%B0swagger%E5%8F%8A%E5%85%B6%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%87%8D%E7%82%B9%E9%98%90%E8%BF%B0%E5%A6%82%E4%BD%95%E5%AF%BC%E5%87%BAswagger%E6%96%87%E6%A1%A3%EF%BC%8C%E6%97%A0%E9%9C%80%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99%E3%80%82">2、本文不阐述swagger及其配置，重点阐述如何导出swagger文档，无需代码编写。</a></p>
<p> <a href="#%E4%BA%8C%20%E5%AE%9E%E7%8E%B0">二 实现</a></p>
<p> <a href="#1%E3%80%81maven%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE">1、maven插件配置</a></p>
<p> <a href="#2%E3%80%81%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%9C%C2%A0">2、配置结果 </a></p>
<p> <a href="#3%E3%80%81%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3">3、配置详解</a></p>
<p> <a href="#4%E3%80%81%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B">4、使用流程</a></p>
<p> <a href="#5%E3%80%81%E9%A1%B9%E7%9B%AEgithub">5、项目github https://github.com/HandsomeMars/swagger-static-api-demo.git</a></p>
<p> <a href="#%E4%B8%89%20%E5%8F%82%E8%80%83">三 参考</a></p>
<p> <a href="#https%3A%2F%2Fgithub.com%2Fasciidoctor%2Fasciidoctor-maven-examples">https://github.com/asciidoctor/asciidoctor-maven-examples</a></p>
<p> <a href="#https%3A%2F%2Fasciidoctor.org%2Fdocs%2Fasciidoctor-maven-plugin%2F">https://asciidoctor.org/docs/asciidoctor-maven-plugin/</a></p>
<p> <a href="#http%3A%2F%2Fswagger2markup.github.io%2Fswagger2markup%2F1.3.1%2F">http://swagger2markup.github.io/swagger2markup/1.3.1/</a></p>
<p> <a href="#https%3A%2F%2Fgithub.com%2FSwagger2Markup%2Fspring-swagger2markup-demo">https://github.com/Swagger2Markup/spring-swagger2markup-demo</a></p>
<hr>
<h2 id="一-前言"><a href="#一-前言" class="headerlink" title="一 前言"></a>一 前言</h2><h3 id="1、swagger作为出色的在线api生成工具，在项目中经常作为前后端接口对接的利器。"><a href="#1、swagger作为出色的在线api生成工具，在项目中经常作为前后端接口对接的利器。" class="headerlink" title="1、swagger作为出色的在线api生成工具，在项目中经常作为前后端接口对接的利器。"></a><em>1、swagger作为出色的在线api生成工具，在项目中经常作为前后端接口对接的利器。</em></h3><p> <em>但是：</em></p>
<ul>
<li>线上的swagger是不安全的，使用不当会导致垃圾数据、是行走的bug和入侵渠道等。 </li>
<li>前后端接口文档意在规约与分工，不适宜完全开发swagger代替接口文档 </li>
<li>但是后期不管是后端接口测试还是前端接口对接实测，又需要维护swagger与接口文档 <em>所以：基于swagger与接口文档同时维护这个需求，有折中方案：</em></li>
</ul>
<ul>
<li>写好swagger接口（定义接口与输入输出），导出离线文档 </li>
<li>前后端同时开发，最后完成联调 </li>
<li>如果接口变化，则重新导出离线文档，达到swagger与接口文档同时维护 <h3 id="2、本文不阐述swagger及其配置，重点阐述如何导出swagger文档，无需代码编写。"><a href="#2、本文不阐述swagger及其配置，重点阐述如何导出swagger文档，无需代码编写。" class="headerlink" title="2、本文不阐述swagger及其配置，重点阐述如何导出swagger文档，无需代码编写。"></a><em>2、本文不阐述swagger及其配置，重点阐述如何导出swagger文档，无需代码编写。</em></h3></li>
</ul>
<hr>
<h2 id="二-实现"><a href="#二-实现" class="headerlink" title="二 实现"></a>二 实现</h2><h3 id="1、maven插件配置"><a href="#1、maven插件配置" class="headerlink" title="1、maven插件配置"></a><em>1、maven插件配置</em></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> &lt;plugin&gt;</span><br><span class="line">	&lt;groupId&gt;io.github.swagger2markup&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;swagger2markup-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.3.1&lt;/version&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;!---swagger-api-json路径--&gt;</span><br><span class="line">		&lt;swaggerInput&gt;http://ip:port/projectname/v2/api-docs&lt;/swaggerInput&gt;</span><br><span class="line">		&lt;!---swagger-api-转换生成路径--&gt;</span><br><span class="line">		&lt;outputFile&gt;$&#123;project.build.directory&#125;/docs/asciidoc/swagger&lt;/outputFile&gt;</span><br><span class="line">		&lt;!---文档生成配置参数--&gt;</span><br><span class="line">		&lt;config&gt;</span><br><span class="line">			&lt;swagger2markup.outputLanguage&gt;ZH&lt;/swagger2markup.outputLanguage&gt;</span><br><span class="line">			&lt;swagger2markup.generatedExamplesEnabled&gt;true&lt;/swagger2markup.generatedExamplesEnabled&gt;</span><br><span class="line">			&lt;swagger2markup.inlineSchemaEnabled&gt;false&lt;/swagger2markup.inlineSchemaEnabled&gt;</span><br><span class="line">			&lt;swagger2markup.pathsGroupedBy&gt;TAGS&lt;/swagger2markup.pathsGroupedBy&gt;</span><br><span class="line">			&lt;swagger2markup.markupLanguage&gt;ASCIIDOC&lt;/swagger2markup.markupLanguage&gt;</span><br><span class="line">		&lt;/config&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">	&lt;groupId&gt;org.asciidoctor&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;asciidoctor-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.5.8&lt;/version&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">		&lt;!--asciidoc文件目录--&gt;</span><br><span class="line">		&lt;sourceDirectory&gt;$&#123;project.build.directory&#125;/docs/asciidoc/&lt;/sourceDirectory&gt;</span><br><span class="line">		&lt;!---生成html的路径--&gt;</span><br><span class="line">		&lt;outputDirectory&gt;$&#123;project.build.directory&#125;/docs/html/&lt;/outputDirectory&gt;</span><br><span class="line">		&lt;!---生成文档类型--&gt;</span><br><span class="line">		&lt;backend&gt;html5&lt;/backend&gt;</span><br><span class="line">		&lt;sourceHighlighter&gt;coderay&lt;/sourceHighlighter&gt;</span><br><span class="line">		&lt;attributes&gt;</span><br><span class="line">			&lt;!--导航栏在左--&gt;</span><br><span class="line">			&lt;toc&gt;left&lt;/toc&gt;</span><br><span class="line">			&lt;!--显示层级数--&gt;</span><br><span class="line">			&lt;toclevels&gt;3&lt;/toclevels&gt;</span><br><span class="line">			&lt;!--自动打数字序号--&gt;</span><br><span class="line">			&lt;sectnums&gt;true&lt;/sectnums&gt;</span><br><span class="line">		&lt;/attributes&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>


<h3 id="2、配置结果"><a href="#2、配置结果" class="headerlink" title="_2、配置结果 _"></a>_2、配置结果 _</h3><p> <img src="https://img-blog.csdnimg.cn/20190725220432990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h3 id="3、配置详解"><a href="#3、配置详解" class="headerlink" title="3、配置详解"></a><em>3、配置详解</em></h3><ul>
<li>swagger2markup配置详解 （常用配置）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> swagger2markup.markupLanguage=ASCIIDOC       ##MarkDown or ASCIIDOC  </span><br><span class="line">swagger2markup.generatedExamplesEnabled=ture ##是否生成输入输出样例</span><br><span class="line">swagger2markup.outputLanguage=ZH             ##文档输出语言  ZH中文</span><br><span class="line">swagger2markup.inlineSchemaEnabled=false     ##是否启用参数内联</span><br><span class="line">swagger2markup.pathsGroupedBy=TAGS           ##api排序规则  一般用tags排序</span><br></pre></td></tr></table></figure>

<p> （参考官方api）</p>
<p> <a href="http://swagger2markup.github.io/swagger2markup/1.3.3/#_swagger2markup_properties" target="_blank" rel="noopener">http://swagger2markup.github.io/swagger2markup/1.3.3/#_swagger2markup_properties</a></p>
<pre><code>名称                                        | 描述                                    | 可能的值                                | 默认          
----------------------------------------- | ------------------------------------- | ----------------------------------- | ------------ 
swagger2markup.markupLanguage             | 指定应用于生成文件的标记语言。                       | ASCIIDOC，MARKDOWN，CONFLUENCE_MARKUP | ASCIIDOC    
swagger2markup.swaggerMarkupLanguage      | 指定Swagger描述中使用的标记语言。                  | ASCIIDOC，MARKDOWN，CONFLUENCE_MARKUP | 降价          
swagger2markup.pathsGroupedBy             | 指定路径的分组方式                             | AS_IS，TAGS，REGEX                    | AS_IS       
swagger2markup.outputLanguage             | 指定标签的语言                               | EN，DE，FR，RU                         | EN          
swagger2markup.lineSeparator              | 指定应使用的行分隔符                            | UNIX，WINDOWS，MAC                    | &amp;lt;系统依赖&amp;gt;
swagger2markup.generatedExamplesEnabled   | 指定是否应生成HTTP请求和响应示例                    | 真假                                  | 假           
swagger2markup.flatBodyEnabled            | 可选地将body参数（如果有）与其他参数隔离                | 真假                                  | 假           
swagger2markup.pathSecuritySectionEnabled | （可选）禁用路径部分的安全性部分                      | 真假                                  | 真正          
swagger2markup.anchorPrefix               | 如果要将生成的文档包含在全局文档中，可以选择为所有锚点添加前缀以获得唯一性 | 任何字符串                               |             
swagger2markup.basePathPrefixEnabled      | 将basePath添加到所有路径                      | 真假                                  | 假           
swagger2markup.headerRegex                | RegEx分组时使用的正则表达式                      | 具有至少一个捕获组的任何有效RegEx模式               |             


名称                               | 描述        | 可能的值                 | 默认
-------------------------------- | --------- | -------------------- | -- 
swagger2markup.tagOrderBy        | 指定全局标记的顺序 | AS_IS，NATURAL，CUSTOM | 自然
swagger2markup.operationOrderBy  | 指定路径操作的顺序 | AS_IS，NATURAL，CUSTOM | 自然
swagger2markup.definitionOrderBy | 指定定义的顺序   | AS_IS，NATURAL，CUSTOM | 自然
swagger2markup.parameterOrderBy  | 指定操作参数的顺序 | AS_IS，NATURAL，CUSTOM | 自然
swagger2markup.propertyOrderBy   | 指定定义属性的顺序 | AS_IS，NATURAL，CUSTOM | 自然
swagger2markup.responseOrderBy   | 指定响应的顺序   | AS_IS，NATURAL，CUSTOM | 自然


名称                                 | 描述         | 可能的值  | 默认  
---------------------------------- | ---------- | ----- | ---- 
swagger2markup.overviewDocument    | 指定概述文档的文件名 | 任何字符串 | “概览”
swagger2markup.pathsDocument       | 指定路径文档的文件名 | 任何字符串 | “路径”
swagger2markup.definitionsDocument | 指定定义文档的文件名 | 任何字符串 | “定义”
swagger2markup.securityDocument    | 指定安全文档的文件名 | 任何字符串 | “安全”


名称                                         | 描述                        | 可能的值       | 默认  
------------------------------------------ | ------------------------- | ---------- | ---- 
swagger2markup.separatedDefinitionsEnabled | 除定义文件外，还为每个模型定义创建单独的定义文件  | 真假         | 假   
swagger2markup.separatedOperationsEnabled  | 除Paths文件外，还为每个操作创建单独的操作文件 | 真假         | 假   
swagger2markup.separatedOperationsFolder   | 指定定义文件的目标文件夹路径            | 任何有效的文件夹名称 | “操作”
swagger2markup.separatedDefinitionsFolder  | 指定操作文件的目标文件夹路径            | 任何有效的文件夹名称 | “定义”


名称                                                 | 描述                  | 可能的值  | 默认
-------------------------------------------------- | ------------------- | ----- | -- 
swagger2markup.interDocumentCrossReferencesEnabled | 在需要时允许使用文档间交叉引用     | 真假    | 假 
swagger2markup.interDocumentCrossReferencesPrefix  | 为高级用法指定所有文档间交叉引用的前缀 | 任何字符串 |   


名称                                 | 描述         | 可能的值 | 默认
---------------------------------- | ---------- | ---- | -- 
swagger2markup.inlineSchemaEnabled | 启用内联对象架构支持 | 真假   | 真正


名称                                | 描述           | 可能的值                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 默认
--------------------------------- | ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -- 
swagger2markup.pageBreakLocations | 指定应插入分页符的位置。 | BEFORE_OPERATION，BEFORE_OPERATION_DESCRIPTION，BEFORE_OPERATION_PARAMETERS，BEFORE_OPERATION_RESPONSES，BEFORE_OPERATION_CONSUMES，BEFORE_OPERATION_PRODUCES，BEFORE_OPERATION_EXAMPLE_REQUEST，BEFORE_OPERATION_EXAMPLE_RESPONSE，BEFORE_DEFINITION，AFTER_OPERATION，AFTER_OPERATION_DESCRIPTION，AFTER_OPERATION_PARAMETERS，AFTER_OPERATION_RESPONSES，AFTER_OPERATION_CONSUMES，AFTER_OPERATION_PRODUCES，AFTER_OPERATION_EXAMPLE_REQUEST，AFTER_OPERATION_EXAMPLE_RESPONSE，AFTER_DEFINITION | 空 </code></pre><ul>
<li>asciidoctor配置详解 （常用配置）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> #需要转换的asciidoc文件位置</span><br><span class="line">sourceDirectory $&#123;project.build.directory&#125;/docs/asciidoc/</span><br><span class="line">#需要转换后的文件输出位置</span><br><span class="line">outputDirectory $&#123;project.build.directory&#125;/docs/html/</span><br><span class="line">#转换使用的模板</span><br><span class="line">backend html5、html</span><br><span class="line">#模板主题</span><br><span class="line">sourceHighlighter coderay</span><br><span class="line"></span><br><span class="line">#其他配置属性</span><br><span class="line">attributes</span><br><span class="line">#导航栏在左#</span><br><span class="line">toc left</span><br><span class="line">#显示层级数</span><br><span class="line">toclevels 3</span><br><span class="line">#自动打数字序号</span><br><span class="line">sectnums true</span><br><span class="line">		、</span><br></pre></td></tr></table></figure>

<p> （官方api配置） </p>
<p> <a href="https://github.com/asciidoctor/asciidoctor-maven-plugin/blob/master/README.adoc" target="_blank" rel="noopener">https://github.com/asciidoctor/asciidoctor-maven-plugin/blob/master/README.adoc</a> </p>
<h3 id="4、使用流程"><a href="#4、使用流程" class="headerlink" title="4、使用流程"></a><em>4、使用流程</em></h3><p> <img src="https://img-blog.csdnimg.cn/20190725222343635.png" alt></p>
<ul>
<li>双击swagger2mark插件生成adoc <img src="https://img-blog.csdnimg.cn/20190725222556330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></li>
</ul>
<ul>
<li>双击 asciidoctor插件生成html <img src="https://img-blog.csdnimg.cn/20190725222653116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></li>
</ul>
<h3 id="5、项目github-https-github-com-HandsomeMars-swagger-static-api-demo-git"><a href="#5、项目github-https-github-com-HandsomeMars-swagger-static-api-demo-git" class="headerlink" title="5、项目github https://github.com/HandsomeMars/swagger-static-api-demo.git"></a><em>5、项目github <a href="https://github.com/HandsomeMars/swagger-static-api-demo.git" target="_blank" rel="noopener">https://github.com/HandsomeMars/swagger-static-api-demo.git</a></em></h3><p> <a href="https://github.com/HandsomeMars/swagger-static-api-demo.git" target="_blank" rel="noopener">https://github.com/HandsomeMars/swagger-static-api-demo.git</a></p>
<hr>
<h1 id="三-参考"><a href="#三-参考" class="headerlink" title="三 参考"></a>三 参考</h1><h3 id="https-github-com-asciidoctor-asciidoctor-maven-examples"><a href="#https-github-com-asciidoctor-asciidoctor-maven-examples" class="headerlink" title="https://github.com/asciidoctor/asciidoctor-maven-examples"></a><em><a href="https://github.com/asciidoctor/asciidoctor-maven-examples" target="_blank" rel="noopener">https://github.com/asciidoctor/asciidoctor-maven-examples</a></em></h3><h3 id="https-asciidoctor-org-docs-asciidoctor-maven-plugin"><a href="#https-asciidoctor-org-docs-asciidoctor-maven-plugin" class="headerlink" title="https://asciidoctor.org/docs/asciidoctor-maven-plugin/"></a><em><a href="https://asciidoctor.org/docs/asciidoctor-maven-plugin/" target="_blank" rel="noopener">https://asciidoctor.org/docs/asciidoctor-maven-plugin/</a></em></h3><h3 id="http-swagger2markup-github-io-swagger2markup-1-3-1"><a href="#http-swagger2markup-github-io-swagger2markup-1-3-1" class="headerlink" title="http://swagger2markup.github.io/swagger2markup/1.3.1/"></a><em><a href="http://swagger2markup.github.io/swagger2markup/1.3.1/" target="_blank" rel="noopener">http://swagger2markup.github.io/swagger2markup/1.3.1/</a></em></h3><h3 id="https-github-com-Swagger2Markup-spring-swagger2markup-demo"><a href="#https-github-com-Swagger2Markup-spring-swagger2markup-demo" class="headerlink" title="https://github.com/Swagger2Markup/spring-swagger2markup-demo"></a><em><a href="https://github.com/Swagger2Markup/spring-swagger2markup-demo" target="_blank" rel="noopener">https://github.com/Swagger2Markup/spring-swagger2markup-demo</a></em></h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/07/06/docker 快速搭建私有镜像仓库registry以及registryUI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/06/docker 快速搭建私有镜像仓库registry以及registryUI/" itemprop="url">docker 快速搭建私有镜像仓库registry以及registryUI</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-06T17:31:33+08:00">
                2019-07-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/94864766" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/94864766</a>   </p>
<p>   <strong>目录</strong></p>
<p> <a href="#%E4%B8%80%E3%80%81%E5%89%8D%E6%8F%90">一、前提</a></p>
<p> <a href="#%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4">二、搭建步骤</a></p>
<p> <a href="#%C2%A0%E4%B8%89%20%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F">三、上传镜像</a></p>
<hr>
<h2 id="一、前提"><a href="#一、前提" class="headerlink" title="一、前提"></a>一、前提</h2><p> <strong><em>1、docker环境（docker for window为例）</em></strong></p>
<p> <strong><em>2、基本命令</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> docker images                    #查看镜像</span><br><span class="line">docker pull [仓库ip:port/]镜像:tag #拉取镜像</span><br><span class="line">docker push [仓库ip:port/]镜像:tag #上传镜像</span><br><span class="line">docker rmi  镜像:tag              #删除镜像</span><br><span class="line">docker tag  镜像名 镜像名:tag     #重命名镜像</span><br><span class="line">docker run  镜像:tag              #运行镜像</span><br><span class="line">docker ps -a                     #docker 进程</span><br></pre></td></tr></table></figure>


<h2 id="二、搭建步骤"><a href="#二、搭建步骤" class="headerlink" title="二、搭建步骤"></a>二、搭建步骤</h2><p> <strong><em>1、安装registry</em></strong></p>
<p> <em>step1：拉取registry</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull registry</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706160407620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> _step2：运行registry _</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5000:5000 --name registry registry</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706160643848.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:5000/v2/</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706171830809.png" alt></p>
<p> <em>** 2、安装registry-web**</em></p>
<p> <em>step1：拉取registry-web</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hyper/docker-registry-web</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>



<p> <img src="https://img-blog.csdnimg.cn/20190706161008149.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> <em>step2：运行registry-web</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5001:8080 --name registry-web --link registry -e REGISTRY_URL=http://registry:5000/v2 -e REGISTRY_NAME=localhost:5000 hyper/docker-registry-web</span><br></pre></td></tr></table></figure>




<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> ##命令注释</span><br><span class="line">docker run                                 ##运行</span><br><span class="line">-d                                         ##后台运行</span><br><span class="line">-p 5001:8080                               ##端口映射</span><br><span class="line">--name registry-web                        ##容器命名</span><br><span class="line">--link registry                            ##连接其他容器  加入registry到host</span><br><span class="line">-e REGISTRY_URL=http://registry:5000/v2    ##指定仓库地址</span><br><span class="line">-e REGISTRY_NAME=localhost:5000            ##仓库命名</span><br><span class="line">hyper/docker-registry-web                  ##被启动的镜像</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706161458690.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:5001</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706171959340.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h2 id="三、上传镜像"><a href="#三、上传镜像" class="headerlink" title="三、上传镜像"></a>三、上传镜像</h2><p> <strong>_ 1、配置仓库（docker for window）_</strong></p>
<p> <em>step1：docker for windows -》setting-》daemon-》添加insecure-registries-》[可选]registry mirrors</em></p>
<p> <img src="https://img-blog.csdnimg.cn/20190706170256541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> _step2：重启服务 _</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> docker start registry</span><br><span class="line">docker start registry-web</span><br></pre></td></tr></table></figure>

<p> <em>** 2、上传镜像**</em></p>
<p> <em>step1：下载测镜像并重命名</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hello-world</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag hello-world localhost:5000/zyj-test:1.0</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> ##注意命名规范</span><br><span class="line">镜像仓库ip:port/镜像名:tag</span><br><span class="line"></span><br><span class="line">##否则push出错</span><br><span class="line">Error response from daemon: manifest for localhost:5000/uifd/ui-for-docker:latest not found</span><br></pre></td></tr></table></figure>



<p> <img src="https://img-blog.csdnimg.cn/20190706170530384.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> _step2:上传镜像 _</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull localhost:5000/zyj/test:1.0</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706170650494.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> 浏览器输入:</span><br><span class="line">http://localhost:5001/</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706171525576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> <em><strong>3、下载镜像</strong></em></p>
<p> <em>step1:删除本地已有镜像</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi localhost:5000/zyj/test:1.0</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706171226273.png" alt></p>
<p> _step2：拉取本地仓库镜像 _</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull localhost:5000/zyj/test:1.0</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190706171325648.png" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/06/28/docker镜像导入导出(windows)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/28/docker镜像导入导出(windows)/" itemprop="url">docker镜像导入导出(windows)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-28T01:45:12+08:00">
                2019-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/93936363" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/93936363</a>   </p>
<p>   一 前提条件</p>
<p> 1、docker for windows 安装 </p>
<p> 2、docker常用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> docker pull 镜像:tag                ##拉去默认仓库tag版本号的镜像</span><br><span class="line">docker images                       ##查询本地仓库的所有镜像</span><br><span class="line">docker rmi 镜像id                   ##删除镜像</span><br><span class="line">docker tag 镜像id 镜像:TAG          ##重命名镜像</span><br><span class="line">docker ps                           ##查询本地容器</span><br><span class="line">docker ps -a                        ##查询本地所有运行的容器</span><br><span class="line">docker export 容器id &gt; x:/xx/xx.tar ##导出容器快照</span><br><span class="line">docker import - x:/xx/xx.tar        ##导入容器快照</span><br><span class="line">docker save 镜像id &gt; x:/xx/xx.tar   ##导出镜像</span><br><span class="line">docker load &lt; x:/xx/xx.tar          ##导入镜像</span><br></pre></td></tr></table></figure>

<p> 二 演示</p>
<p> 1、下载镜像（mysql为例）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql</span><br></pre></td></tr></table></figure>

<p> 2、查看镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628012537306.png" alt></p>
<p> 3、导出镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> docker save c7109f74d339 &gt; f:\docker\images\mysql.tar</span><br><span class="line"></span><br><span class="line">##备注 c7109f74d339为镜像id [空格] &gt; [空格] f:\docker\images\mysql.tar为打包文件绝对路径</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628012638157.png" alt></p>
<p> 4、删除镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> docker rmi c7109f74d339</span><br><span class="line"></span><br><span class="line">##备注 c7109f74d339为容器id</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628013213588.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> 5、导入镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> docker load &lt; f:\docker\images\mysql.tar</span><br><span class="line"></span><br><span class="line">##备注  [空格] &lt; [空格] f:\docker\images\mysql.tar为打包文件绝对路径</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628012932245.png" alt><img src="https://img-blog.csdnimg.cn/20190628013713393.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> 6 镜像重命名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> docker tag c7109f74d339 mysql:8.0</span><br><span class="line"></span><br><span class="line">##备注 c7109f74d339为容器id mysql:8.0为镜像:TAG</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628013924422.png" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/06/28/docker for Windows简易教程(win10安装非boot2docker)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/28/docker for Windows简易教程(win10安装非boot2docker)/" itemprop="url">docker for Windows简易教程(win10安装非boot2docker)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-28T00:11:03+08:00">
                2019-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/93926555" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/93926555</a>   </p>
<h1 id="一-前提条件"><a href="#一-前提条件" class="headerlink" title="一 前提条件"></a>一 前提条件</h1><h3 id="1、win10操作系统（win10专业版更好）本机使用win10家庭版为例"><a href="#1、win10操作系统（win10专业版更好）本机使用win10家庭版为例" class="headerlink" title="1、win10操作系统（win10专业版更好）本机使用win10家庭版为例"></a>1、win10操作系统（win10专业版更好）本机使用win10家庭版为例</h3><h3 id="2、自行选择下载需要的Docker-for-Windows-docker-windows地址"><a href="#2、自行选择下载需要的Docker-for-Windows-docker-windows地址" class="headerlink" title="2、自行选择下载需要的Docker for Windows docker windows地址"></a>2、自行选择下载需要的Docker for Windows <a href="https://www.docker.com/get-started" target="_blank" rel="noopener">docker windows地址</a></h3><h3 id="3、Hyper-V虚拟机介绍"><a href="#3、Hyper-V虚拟机介绍" class="headerlink" title="3、Hyper-V虚拟机介绍"></a>3、<a href="https://blog.csdn.net/Ellen5203/article/details/81208384" target="_blank" rel="noopener">Hyper-V虚拟机介绍</a></h3><h1 id="二-步骤向导"><a href="#二-步骤向导" class="headerlink" title="二 步骤向导"></a>二 步骤向导</h1><h3 id="1、安装或开启Htype-V"><a href="#1、安装或开启Htype-V" class="headerlink" title="1、安装或开启Htype-V"></a>1、安装或开启Htype-V</h3><h3 id="2、安装docker-for-windows"><a href="#2、安装docker-for-windows" class="headerlink" title="2、安装docker for windows"></a>2、安装docker for windows</h3><h3 id="3、验证docker"><a href="#3、验证docker" class="headerlink" title="3、验证docker"></a>3、验证docker</h3><h3 id="3、配置docker"><a href="#3、配置docker" class="headerlink" title="3、配置docker"></a>3、配置docker</h3><h1 id="三-安装"><a href="#三-安装" class="headerlink" title="三 安装"></a>三 安装</h1><h3 id="1、安装docker-for-windows"><a href="#1、安装docker-for-windows" class="headerlink" title="1、安装docker for windows"></a>1、安装docker for windows</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> step1:控制面板-》程序和功能-》启用或关闭windows功能-》勾选Hyper-V</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ps：若为家庭版有可能没有Hyper-v 以及 docker安装会提示windows非专业版</span><br><span class="line">    解决方法附后</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> step1.1：安装Htype-V </span><br><span class="line"></span><br><span class="line">###############################复制为以下脚本bat文件#####################################</span><br><span class="line"></span><br><span class="line">pushd &quot;%~dp0&quot; </span><br><span class="line"></span><br><span class="line">dir /b %SystemRoot%\servicing\Packages\*Hyper-V*.mum &gt;hyper-v.txt </span><br><span class="line"></span><br><span class="line">for /f %%i in (&apos;findstr /i . hyper-v.txt 2^&gt;nul&apos;) do dism /online /norestart /add-package:&quot;%SystemRoot%\servicing\Packages\%%i&quot;</span><br><span class="line"></span><br><span class="line">del hyper-v.txt</span><br><span class="line"></span><br><span class="line">Dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /LimitAccess /ALL</span><br><span class="line"></span><br><span class="line">######################################以管理员权限运行###################################</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> step1.2:伪装windows家庭版为windows专业版</span><br><span class="line"></span><br><span class="line">###############################复制为以下脚本bat文件#####################################</span><br><span class="line"></span><br><span class="line">REG ADD &quot;HKEY_LOCAL_MACHINE\software\Microsoft\Windows NT\CurrentVersion&quot; /v EditionId /T REG_EXPAND_SZ /d Professional /F</span><br><span class="line"></span><br><span class="line">######################################以管理员权限运行###################################</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> step2:安装docker for windows 按提示安装完成</span><br><span class="line"></span><br><span class="line">ps：安装过程中360提示黑客创建账号of 此为docker获取计算机管理员权限 请运行通过</span><br></pre></td></tr></table></figure>



<p> <img src="https://img-blog.csdnimg.cn/20190627233645834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> <img src="https://img-blog.csdnimg.cn/20190627235330709.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h3 id="2、验证docker环境"><a href="#2、验证docker环境" class="headerlink" title="2、验证docker环境"></a>2、验证docker环境</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190627235506717.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<h3 id="3、基本配置"><a href="#3、基本配置" class="headerlink" title="3、基本配置"></a>3、基本配置</h3><h3 id="（1）设置docker虚拟机位置（默认c盘-占用空间）"><a href="#（1）设置docker虚拟机位置（默认c盘-占用空间）" class="headerlink" title="（1）设置docker虚拟机位置（默认c盘 占用空间）"></a>（1）设置docker虚拟机位置（默认c盘 占用空间）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> docker托盘-》setting-》Advanced-》disk image location</span><br><span class="line"></span><br><span class="line">自定义位置-》apply-》docker自动重启生效</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190627235755956.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> <img src="https://img-blog.csdnimg.cn/20190628000018109.png" alt></p>
<h3 id="（2）配置镜像库位置"><a href="#（2）配置镜像库位置" class="headerlink" title="（2）配置镜像库位置"></a>（2）配置镜像库位置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> docker托盘-》setting-》Daemom-》Registry mirrors</span><br><span class="line"></span><br><span class="line">自定义位置-》apply-》docker自动重启生效</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 国内docker 镜像地址</span><br><span class="line">阿里云下载地址（linux）：https://hub.daocloud.io/</span><br><span class="line">阿里云下载地址（Mac）： http://mirrors.aliyun.com/docker-toolbox/mac/docker-for-mac/</span><br><span class="line">阿里云下载地址（Windows）： http://mirrors.aliyun.com/docker-toolbox/windows/docker-for-windows/</span><br><span class="line">##注意windows家庭版使用的linux容器版 只有windows专业版 可以通过切换为windows容器版</span><br></pre></td></tr></table></figure>

<p> <img src="https://img-blog.csdnimg.cn/20190628082002262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIyMjExMjE3,size_16,color_FFFFFF,t_70" alt></p>
<p> 祝你成功</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/06/03/解决oracle11g ORA-00119 和 ORA-00132错误/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/03/解决oracle11g ORA-00119 和 ORA-00132错误/" itemprop="url">解决oracle11g ORA-00119 和 ORA-00132错误</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-03T01:23:19+08:00">
                2019-06-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/90741214" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/90741214</a>   </p>
<h1 id="一-前言"><a href="#一-前言" class="headerlink" title="一 前言"></a>一 前言</h1><h3 id="1、一次华丽的oracle数据库宕机事件，首先监听与服务均正常启动着，所有的连接显示TNC错误，但sqlplus正常连接，无法登录用户。"><a href="#1、一次华丽的oracle数据库宕机事件，首先监听与服务均正常启动着，所有的连接显示TNC错误，但sqlplus正常连接，无法登录用户。" class="headerlink" title="1、一次华丽的oracle数据库宕机事件，首先监听与服务均正常启动着，所有的连接显示TNC错误，但sqlplus正常连接，无法登录用户。"></a>1、一次华丽的oracle数据库宕机事件，首先监听与服务均正常启动着，所有的连接显示TNC错误，但sqlplus正常连接，无法登录用户。</h3><h3 id="2、sqlplus-nolog-重启数据库，显示ORA-00119和ORA-00132错误，打开oracle日志显示未找到-‘LISENER-XXXX’。"><a href="#2、sqlplus-nolog-重启数据库，显示ORA-00119和ORA-00132错误，打开oracle日志显示未找到-‘LISENER-XXXX’。" class="headerlink" title="2、sqlplus/nolog 重启数据库，显示ORA-00119和ORA-00132错误，打开oracle日志显示未找到 ‘LISENER-XXXX’。"></a>2、sqlplus/nolog 重启数据库，显示ORA-00119和ORA-00132错误，打开oracle日志显示未找到 ‘LISENER-XXXX’。</h3><h3 id="3、so综上-监听服务为何配置出现错误导致数据库无法连接，重启数据库服务也开启不了对应监听服务。"><a href="#3、so综上-监听服务为何配置出现错误导致数据库无法连接，重启数据库服务也开启不了对应监听服务。" class="headerlink" title="3、so综上 监听服务为何配置出现错误导致数据库无法连接，重启数据库服务也开启不了对应监听服务。"></a>3、so综上 监听服务为何配置出现错误导致数据库无法连接，重启数据库服务也开启不了对应监听服务。</h3><h2 id="二-方案"><a href="#二-方案" class="headerlink" title="二 方案"></a>二 方案</h2><p> 重新配置监听</p>
<h3 id="1、使用oracle管理工具（Net-Configuration-Assistant）进行配置监听-略"><a href="#1、使用oracle管理工具（Net-Configuration-Assistant）进行配置监听-略" class="headerlink" title="1、使用oracle管理工具（Net Configuration Assistant）进行配置监听(略)"></a>1、使用oracle管理工具（Net Configuration Assistant）进行配置监听(略)</h3><h3 id="2、修改监听配置文件"><a href="#2、修改监听配置文件" class="headerlink" title="2、修改监听配置文件"></a>2、修改监听配置文件</h3><h3 id="（1）查看监听配置文件并备份"><a href="#（1）查看监听配置文件并备份" class="headerlink" title="（1）查看监听配置文件并备份"></a>（1）查看监听配置文件并备份</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> 安装目录：&#123;请根据安装配置路径寻找&#125;</span><br><span class="line">D:\app\product\11.2.0\server\NETWORK\ADMIN</span><br><span class="line">server为oracle主目录不同安装环境不一样</span><br><span class="line"></span><br><span class="line">需要修改的配置文件：</span><br><span class="line">listener.ora 监听配置文件（服务器）</span><br><span class="line">tnsnames.ora 监听命名配置文件（客户端）</span><br></pre></td></tr></table></figure>

<p> listener.ora模板</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> ##sid配置（不使用sid 可去除）</span><br><span class="line">SID_LIST_LISTENER =</span><br><span class="line">  (SID_LIST =</span><br><span class="line">    (SID_DESC =</span><br><span class="line">      (SID_NAME = PLSExtProc)</span><br><span class="line">      (ORACLE_HOME = D:\app\oracle\product\11.2.0\server)</span><br><span class="line">      (PROGRAM = extproc)</span><br><span class="line">    )</span><br><span class="line">    (SID_DESC =</span><br><span class="line">      (SID_NAME = CLRExtProc)</span><br><span class="line">      (ORACLE_HOME = D:\app\oracle\product\11.2.0\server)</span><br><span class="line">      (PROGRAM = extproc)</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##本地监听配置</span><br><span class="line">LISTENER =</span><br><span class="line">  (DESCRIPTION_LIST =</span><br><span class="line">    (DESCRIPTION =</span><br><span class="line">      ##本地ipc协议配置 可去除</span><br><span class="line">      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))</span><br><span class="line">      ##关键配置</span><br><span class="line">      (ADDRESS = (PROTOCOL = TCP)(HOST = &apos;计算机全名&apos;)(PORT = 1521))</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DEFAULT_SERVICE_LISTENER = (XE)</span><br><span class="line"></span><br><span class="line">##计算机全名获取方式：  桌面-》我的电脑-》右击属性-》计算机名、域或工作组设置-》计算机名##</span><br><span class="line">##DEFAULT_SERVICE_LISTENER = (XE) 不知具体作用##</span><br></pre></td></tr></table></figure>

<p> tnsnames.ora模板</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> ##远程sid注册配置（可去去除）</span><br><span class="line">EXTPROC_CONNECTION_DATA =</span><br><span class="line">  (DESCRIPTION =</span><br><span class="line">    (ADDRESS_LIST =</span><br><span class="line">      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1))</span><br><span class="line">    )</span><br><span class="line">    (CONNECT_DATA =</span><br><span class="line">      (SID = PLSExtProc)</span><br><span class="line">      (PRESENTATION = RO)</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">ORACLR_CONNECTION_DATA = </span><br><span class="line">  (DESCRIPTION = </span><br><span class="line">    (ADDRESS_LIST = </span><br><span class="line">      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1)) </span><br><span class="line">    ) </span><br><span class="line">    (CONNECT_DATA = </span><br><span class="line">      (SID = CLRExtProc) </span><br><span class="line">      (PRESENTATION = RO) </span><br><span class="line">    ) </span><br><span class="line">  ) </span><br><span class="line"></span><br><span class="line">##远程服务注册</span><br><span class="line">XE_LISTENER=</span><br><span class="line">  (DESCRIPTION =</span><br><span class="line">    (ADDRESS = (PROTOCOL = TCP)(HOST = 目标计算机全名or目标ip )(PORT = 1521))</span><br><span class="line">    (CONNECT_DATA =</span><br><span class="line">      (SERVER = DEDICATED)</span><br><span class="line">      (SERVICE_NAME = XE)</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">## XE_LISTENER为客户端监听名（可自定义）  XE为服务名 ##</span><br><span class="line">## 远程服务注册中 当服务与客户端同一主机时可使用计算机全名##</span><br></pre></td></tr></table></figure>


<h3 id="（2）按照配置检查并修改上述配置文件"><a href="#（2）按照配置检查并修改上述配置文件" class="headerlink" title="（2）按照配置检查并修改上述配置文件"></a>（2）按照配置检查并修改上述配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> 1  window + R  打开 services.msc     (服务列表)</span><br><span class="line">2  重启OracleServiceXE              （服务先重启）</span><br><span class="line">3  重启OracleXETNSListener          （监听后重启）</span><br><span class="line">4  window + R  打开 cmd</span><br><span class="line">5  sqlplus/no log</span><br><span class="line">6  startup</span><br><span class="line"></span><br><span class="line">##XE为tnsnames.ora  中servername##</span><br><span class="line">##有许多数据库名字为ORCL##</span><br></pre></td></tr></table></figure>

<p> cms提示实例已经重启即可</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/04/11/windows配置ICE环境变量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/11/windows配置ICE环境变量/" itemprop="url">windows配置ICE环境变量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-11T01:18:18+08:00">
                2019-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/89200417" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/89200417</a>   </p>
<p>   一 前言</p>
<p> 1、ice是目前性能最高的rpc框架，且兼备跨语言特性，但是文档稀少不便研究（后续补充关于ice的java应用）。</p>
<p> 2、本文简单介绍ice环境变量配置（ice 3.6.2为例）</p>
<p> 3、下载地址<a href="https://zeroc.com/downloads/ice#windows" target="_blank" rel="noopener">zeroc官网windows</a></p>
<p> 二 配置</p>
<p> step1：安装软件（略）</p>
<p> setp2：设置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> 新建变量：</span><br><span class="line">ICE_HOME = ICE安装根目录（bin上一级）</span><br><span class="line"></span><br><span class="line">path添加:</span><br><span class="line">WIN10  path添加一行   %ICE_HOME%/bin</span><br><span class="line"></span><br><span class="line">WIN7/8 path末尾添加   ;%ICE_HOME%/bin</span><br></pre></td></tr></table></figure>

<p> step3：cmd验证</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> C:\Users\mechrevo&gt;slice2java -v</span><br><span class="line">3.6.2</span><br></pre></td></tr></table></figure>

<p> step4：有需要则设置classpath（将需要的lib中的包加入classpath）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> 配置classpath</span><br><span class="line"></span><br><span class="line">WIN10   classpath 新增</span><br><span class="line">%ICE_HOME%\lib\ice-3.6.2.jar</span><br><span class="line">%ICE_HOME%\lib\freeze-3.6.2.jar</span><br><span class="line">%ICE_HOME%\lib\db.jar</span><br><span class="line"></span><br><span class="line">WIN7/8  classpath末尾追加 ;%ICE_HOME%\lib\Ice.jar;%ICE_HOME%\lib\Freeze.jar;%ICE_HOME%\lib\db.jar</span><br></pre></td></tr></table></figure>





          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/03/28/oracle实现增量语句修改表的字段/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/28/oracle实现增量语句修改表的字段/" itemprop="url">oracle实现增量语句修改表的字段</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-28T23:46:26+08:00">
                2019-03-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/88880432" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/88880432</a>   </p>
<p>   一 前言</p>
<p> 1、相对mysql，oracle支持更多的语法，其中之一就是块语句。</p>
<p> 2、本文使用简单的块语句实现，可以一个套路实现多种语句增量操作。</p>
<p> 二 实现</p>
<p> 1、实现思路</p>
<ol>
<li>思路查询是否满足操作条件 </li>
<li>执行满足条件的操作 2、实现前提</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"> -- 查询当前表空间</span><br><span class="line">SELECT USER FROM dual;</span><br><span class="line"></span><br><span class="line">-- 查询数据库字段信息</span><br><span class="line">SELECT * FROM all_tab_cols;</span><br><span class="line"></span><br><span class="line">-- 过滤当前数据库信息</span><br><span class="line">SELECT * FROM all_tab_cols </span><br><span class="line">WHERE OWNER=(SELECT USER FROM dual);</span><br><span class="line"></span><br><span class="line">-- 过滤当前数据库的表的信息</span><br><span class="line">SELECT * FROM all_tab_cols </span><br><span class="line">WHERE OWNER=(SELECT USER FROM dual) </span><br><span class="line">AND table_name = &apos;表名&apos;;</span><br><span class="line"></span><br><span class="line">-- 过滤当前数据库的表的信息</span><br><span class="line">SELECT * FROM all_tab_cols </span><br><span class="line">WHERE OWNER=(SELECT USER FROM dual) </span><br><span class="line">AND table_name = &apos;表名&apos; </span><br><span class="line">AND column_name = &apos;字段名&apos;;</span><br><span class="line"></span><br><span class="line">-- 增加一个字段</span><br><span class="line">alter table  表名  add (字段  字段类型)  [ default  &apos;输入默认值&apos;]  [null/not null];</span><br><span class="line"></span><br><span class="line">-- 修改一个字段</span><br><span class="line">alter table  表名  modiy </span><br><span class="line">(字段  字段类型  [default &apos;默认值&apos; ] [null/not null] ,</span><br><span class="line"> 字段  字段类型  [default &apos;默认值&apos; ] [null/not null] );</span><br><span class="line"></span><br><span class="line">-- 删除一个字段</span><br><span class="line">alter table  表名  drop (字段);</span><br><span class="line"></span><br><span class="line">-- 添加注释</span><br><span class="line">comment on column  库名.表名.字段名 is &apos;备注&apos;;</span><br><span class="line"></span><br><span class="line">-- 定义变量</span><br><span class="line">declare 变量名 number;</span><br><span class="line"></span><br><span class="line">-- 执行sql（块语句中）</span><br><span class="line">execute immediate &apos;sql语句，语句中&apos;&apos;双引号&apos;&apos;即两个单引号&apos;;</span><br><span class="line"></span><br><span class="line">-- 条件分支（块语句中）</span><br><span class="line">IF 变量名=0 THEN</span><br><span class="line">execute immediate &apos;SELECT &apos;&apos;变量名&apos;&apos; FROM DUAL&apos;;</span><br><span class="line">ELSE </span><br><span class="line">execute immediate &apos;SELECT &apos;&apos;变量名&apos;&apos; FROM DUAL&apos;;</span><br><span class="line">END IF;</span><br><span class="line"></span><br><span class="line">-- 块语句</span><br><span class="line">declare 变量名 number;</span><br><span class="line">BEGIN</span><br><span class="line">IF 变量名=0 THEN</span><br><span class="line">execute immediate &apos;SELECT &apos;&apos;变量名&apos;&apos; FROM DUAL&apos;;</span><br><span class="line">ELSE </span><br><span class="line">execute immediate &apos;SELECT &apos;&apos;变量名&apos;&apos; FROM DUAL&apos;;</span><br><span class="line">END IF;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p> 3、增量添加一个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> -- 声明变量</span><br><span class="line">declare num number;</span><br><span class="line">-- 声明变量</span><br><span class="line"></span><br><span class="line">-- 块语句</span><br><span class="line">begin</span><br><span class="line"></span><br><span class="line">    -- 查询条件</span><br><span class="line">    select count(1) into num</span><br><span class="line">	FROM</span><br><span class="line">		all_tab_cols</span><br><span class="line">	WHERE</span><br><span class="line">		OWNER = (SELECT USER FROM dual)</span><br><span class="line">	AND table_name = &apos;表名&apos;</span><br><span class="line">	AND column_name = &apos;字段名&apos; ;</span><br><span class="line">    -- 查询条件</span><br><span class="line"></span><br><span class="line">    --条件判断</span><br><span class="line">	IF num = 0 THEN</span><br><span class="line">	EXECUTE IMMEDIATE &apos;alter table 表名 add (字段名 varchar2(32) default &apos;&apos;默认值&apos;&apos; not null)&apos;; </span><br><span class="line">        EXECUTE IMMEDIATE &apos;comment on column 表名.字段名 is &apos;&apos;注释&apos;&apos;&apos; ;</span><br><span class="line">	END IF ;</span><br><span class="line">    --条件判断</span><br><span class="line"></span><br><span class="line">END;</span><br><span class="line">-- 块语句</span><br></pre></td></tr></table></figure>

<p> 三 总结</p>
<p> 1、如法炮制即可</p>
<p> 2、mysql请参考<a href="https://blog.csdn.net/qq_22211217/article/details/88660634" target="_blank" rel="noopener">mysql实现增量语句修改表的字段</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://HandsomeMars.github.io/2019/03/19/mysql实现增量语句修改表的字段/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yujiang zheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yujiang-zheng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/19/mysql实现增量语句修改表的字段/" itemprop="url">mysql实现增量语句修改表的字段</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-19T14:54:50+08:00">
                2019-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> </a> 版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 by-sa </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href="https://blog.csdn.net/qq_22211217/article/details/88660634" target="_blank" rel="noopener">https://blog.csdn.net/qq_22211217/article/details/88660634</a>   </p>
<p>   一 前言</p>
<p> 1、数据库增量语句：基于现有语句实现增量更新且多次执行增量语句不会影响最终结果。即满足幂等操作。</p>
<p> 2、mysql似乎不支持不建立存储过程/函数情况，直接执行块语句。。。这点有些蛋疼</p>
<p> 3、本文以存储过程为例。</p>
<p> 二 实现</p>
<p> 1、思路</p>
<ol>
<li>查询是否满足条件 </li>
<li>执行满足条件的操作 </li>
<li>删除所有临时变量 2、实现前提</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"> -- 查询当前库表信息</span><br><span class="line">SELECT * FROM information_schema. COLUMNS WHERE TABLE_SCHEMA = (SELECT DATABASE())</span><br><span class="line"></span><br><span class="line">-- 查询当前库某表信息</span><br><span class="line">SELECT * FROM information_schema. COLUMNS WHERE TABLE_SCHEMA = (SELECT DATABASE()) </span><br><span class="line">AND TABLE_NAME = &apos;表名&apos;</span><br><span class="line"></span><br><span class="line">-- 查询当前库某表某字段信息</span><br><span class="line">SELECT * FROM information_schema. COLUMNS WHERE TABLE_SCHEMA = (SELECT DATABASE()) </span><br><span class="line">AND TABLE_NAME = &apos;表名&apos;</span><br><span class="line">AND COLUMN_NAME = &apos;字段名&apos;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">-- 删除某个表字段（不能有引号）</span><br><span class="line">alter table 表名 drop column 字段名; </span><br><span class="line">-- 添加某个表字段（不能有引号）</span><br><span class="line">alter table 表名 add 字段名 varchar(128) comment &apos;备注等&apos;;</span><br><span class="line">-- 修改某个表字段（不能有引号）</span><br><span class="line">alter table 表名 change 旧字段名 新字段名 varchar(128) comment &apos;备注等&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 实现用户变量</span><br><span class="line">SET @变量名=&apos;变量值&apos;;</span><br><span class="line">SELECT @变量名;</span><br><span class="line"></span><br><span class="line">-- 实现条件语句（必须在代码块中）</span><br><span class="line">IF @变量=&apos;变量值&apos; THEN </span><br><span class="line">SELECT @变量名;</span><br><span class="line">END IF;</span><br><span class="line"></span><br><span class="line">-- 删除存储函数</span><br><span class="line">DROP PROCEDURE IF EXISTS deptProc; </span><br><span class="line"></span><br><span class="line">-- 创建存储函数</span><br><span class="line">DELIMITER //</span><br><span class="line">CREATE PROCEDURE deptProc() </span><br><span class="line">BEGIN</span><br><span class="line">SET @变量名=&apos;变量值&apos;;</span><br><span class="line">SELECT @变量名;</span><br><span class="line">IF @变量=&apos;变量值&apos; THEN </span><br><span class="line">SELECT @变量名;</span><br><span class="line">END IF;</span><br><span class="line">END//</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 调用存储函数</span><br><span class="line">CALL deptProc();</span><br></pre></td></tr></table></figure>

<p> 3、增量添加某个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> -- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc; </span><br><span class="line"></span><br><span class="line">DELIMITER //</span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line">CREATE PROCEDURE testProc() </span><br><span class="line">BEGIN</span><br><span class="line">    -- 查询条件</span><br><span class="line">	SELECT</span><br><span class="line">		COUNT(*) into @y</span><br><span class="line">	FROM</span><br><span class="line">		information_schema. COLUMNS</span><br><span class="line">	WHERE</span><br><span class="line">        TABLE_SCHEMA = (SELECT DATABASE())</span><br><span class="line">		 AND TABLE_NAME = &apos;表名&apos;</span><br><span class="line">	     AND COLUMN_NAME = &apos;字段名&apos;;</span><br><span class="line">    -- 查询条件</span><br><span class="line"></span><br><span class="line">    -- 判断存在</span><br><span class="line">    IF @y=0 THEN </span><br><span class="line">        alter table 表名 add 字段名 varchar(32)  comment &apos;备注等&apos;;</span><br><span class="line">    -- ELSEIF alter table 表名 change 字段名 字段名 varchar(32)  comment &apos;备注等&apos;;</span><br><span class="line">    END IF;</span><br><span class="line">    -- 判断存在</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">//DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL testProc(); </span><br><span class="line"></span><br><span class="line">-- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc;</span><br></pre></td></tr></table></figure>

<p> 4、增量修改某个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> -- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc; </span><br><span class="line"></span><br><span class="line">DELIMITER //</span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line">CREATE PROCEDURE testProc() </span><br><span class="line">BEGIN</span><br><span class="line">    -- 查询条件</span><br><span class="line">	SELECT</span><br><span class="line">		COUNT(*) into @y</span><br><span class="line">	FROM</span><br><span class="line">		information_schema. COLUMNS</span><br><span class="line">	WHERE</span><br><span class="line">        TABLE_SCHEMA = (SELECT DATABASE())</span><br><span class="line">		 AND TABLE_NAME = &apos;表名&apos;</span><br><span class="line">	     AND COLUMN_NAME = &apos;旧字段名&apos;;</span><br><span class="line">    -- 查询条件</span><br><span class="line"></span><br><span class="line">    -- 判断存在</span><br><span class="line">    IF @y=1 THEN </span><br><span class="line">        alter table 表名 change 旧字段名 新字段名 varchar(32)  comment &apos;备注等&apos;;</span><br><span class="line">    -- ELSEIF @y =0 THEN  alter table 表名 add 新字段名 varchar(32)  comment &apos;备注等&apos;;</span><br><span class="line">    END IF;</span><br><span class="line">    -- 判断存在</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">//DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL testProc(); </span><br><span class="line"></span><br><span class="line">-- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc;</span><br></pre></td></tr></table></figure>

<p> 4、增量删除某个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> -- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc; </span><br><span class="line"></span><br><span class="line">DELIMITER //</span><br><span class="line"></span><br><span class="line">-- 创建存储过程</span><br><span class="line">CREATE PROCEDURE testProc() </span><br><span class="line">BEGIN</span><br><span class="line">    -- 查询条件</span><br><span class="line">	SELECT</span><br><span class="line">		COUNT(*) into @y</span><br><span class="line">	FROM</span><br><span class="line">		information_schema. COLUMNS</span><br><span class="line">	WHERE</span><br><span class="line">        TABLE_SCHEMA = (SELECT DATABASE())</span><br><span class="line">		 AND TABLE_NAME = &apos;表名&apos;</span><br><span class="line">	     AND COLUMN_NAME = &apos;旧字段名&apos;;</span><br><span class="line">    -- 查询条件</span><br><span class="line"></span><br><span class="line">    -- 判断存在</span><br><span class="line">    IF @y=1 THEN </span><br><span class="line">        alter table 表名 drop 旧字段名;</span><br><span class="line">    END IF;</span><br><span class="line">    -- 判断存在</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">//DELIMITER ;</span><br><span class="line"></span><br><span class="line">-- 调用存储过程</span><br><span class="line">CALL testProc(); </span><br><span class="line"></span><br><span class="line">-- 删除存储过程</span><br><span class="line">DROP PROCEDURE IF EXISTS testProc;</span><br></pre></td></tr></table></figure>

<p> 三、总结</p>
<p> 1、增量语句写法类似于编写幂等接口，实现多次操作结果一致。</p>
<p> 2、实例中多次使用存储函数创建和删除，实在是因为块语句无法脱离存储过程/函数执行</p>
<p> 3、祝你成功</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">yujiang zheng</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yujiang zheng</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
